<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (1.8.0_151) on Mon Jan 13 10:47:43 CET 2020 -->
<title>U2FApplet</title>
<meta name="date" content="2020-01-13">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="U2FApplet";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":9,"i7":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../de/tsenger/u2f/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/U2FApplet.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../de/tsenger/u2f/States.html" title="class in de.tsenger.u2f"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?de/tsenger/u2f/U2FApplet.html" target="_top">Frames</a></li>
<li><a href="U2FApplet.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">de.tsenger.u2f</div>
<h2 title="Class U2FApplet" class="title">Class U2FApplet</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>javacard.framework.Applet</li>
<li>
<ul class="inheritance">
<li>de.tsenger.u2f.U2FApplet</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>javacardx.apdu.ExtendedLength</dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">U2FApplet</span>
extends javacard.framework.Applet
implements javacardx.apdu.ExtendedLength</pre>
<dl>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>1.33</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Tobias Senger</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#APDU_APPLICATION_PARAMETER_OFFSET">APDU_APPLICATION_PARAMETER_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#APDU_CHALLENGE_OFFSET">APDU_CHALLENGE_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#attestationCertificate">attestationCertificate</a></span></code>
<div class="block">permanent store for the attestation certificate</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static javacard.security.ECPrivateKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#attestationPrivateKey">attestationPrivateKey</a></span></code>
<div class="block">stores the private key of the attestation certificate</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static javacard.security.Signature</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#attestationSignature">attestationSignature</a></span></code>
<div class="block">signature instance for attestation certificate signing</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#counterOverflowed">counterOverflowed</a></span></code>
<div class="block">Saves the state for the signing counter.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#ENROLL_FIXED_RESPONSE_SIZE">ENROLL_FIXED_RESPONSE_SIZE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#ENROLL_KEY_HANDLE_LENGTH_OFFSET">ENROLL_KEY_HANDLE_LENGTH_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#ENROLL_KEY_HANDLE_OFFSET">ENROLL_KEY_HANDLE_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#ENROLL_LEGACY_VERSION">ENROLL_LEGACY_VERSION</a></span></code>
<div class="block">fix value defined in FIDO specification "FIDO U2F Raw Message Formats"</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#ENROLL_PUBLIC_KEY_OFFSET">ENROLL_PUBLIC_KEY_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#FIDO_CLA">FIDO_CLA</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#FIDO_INS_AUTHENTICATE">FIDO_INS_AUTHENTICATE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#FIDO_INS_U2F_REGISTER">FIDO_INS_U2F_REGISTER</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#FIDO_INS_VERSION">FIDO_INS_VERSION</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#FIDO_SW_INVALID_KEY_HANDLE">FIDO_SW_INVALID_KEY_HANDLE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#FIDO_SW_TEST_OF_PRESENCE_REQUIRED">FIDO_SW_TEST_OF_PRESENCE_REQUIRED</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="../../../de/tsenger/u2f/FIDOCCImplementation.html" title="class in de.tsenger.u2f">FIDOCCImplementation</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#fidoImpl">fidoImpl</a></span></code>
<div class="block">instance of FIDO API crypto implementation, here the pseudo code of FIDO U2F PP gets real ...</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#fidoSigningCounter">fidoSigningCounter</a></span></code>
<div class="block">counts FIDO signing operations with EC private Key</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#FLAG_USER_PRESENCE_VERIFIED">FLAG_USER_PRESENCE_VERIFIED</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#flags">flags</a></span></code>
<div class="block">provide 0x00 for normal operation at installation, or 0x01 to disable user presence check (for automated FIDO interoperability tests)</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#INSTALL_FLAG_DISABLE_USER_PRESENCE">INSTALL_FLAG_DISABLE_USER_PRESENCE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#ISO_INS_GET_RESPONSE">ISO_INS_GET_RESPONSE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#KEYHANDLE_MAX">KEYHANDLE_MAX</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected javacard.security.ECPrivateKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#localPrivateKey">localPrivateKey</a></span></code>
<div class="block">private key for FIDO signing operation</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static javacard.security.Signature</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#localSignature">localSignature</a></span></code>
<div class="block">signature instance for FIDO signing operation</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#P1_SIGN_CHECK_ONLY">P1_SIGN_CHECK_ONLY</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#P1_SIGN_DONT_ENFORCE_USER_PRESENCE_AND_SIGN">P1_SIGN_DONT_ENFORCE_USER_PRESENCE_AND_SIGN</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#P1_SIGN_ENFORCE_USER_PRESENCE_AND_SIGN">P1_SIGN_ENFORCE_USER_PRESENCE_AND_SIGN</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#PROPRIETARY_CLA">PROPRIETARY_CLA</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#RFU_ENROLL_SIGNED_VERSION">RFU_ENROLL_SIGNED_VERSION</a></span></code>
<div class="block">fix value defined in FIDO specification "FIDO U2F Raw Message Formats"</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#scratch">scratch</a></span></code>
<div class="block">working buffer for reading commands, building responses and temporary data</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_CURRENT_OFFSET">SCRATCH_CURRENT_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_FULL_LENGTH">SCRATCH_FULL_LENGTH</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_INCLUDE_CERT">SCRATCH_INCLUDE_CERT</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_KEY_HANDLE_LENGTH_OFFSET">SCRATCH_KEY_HANDLE_LENGTH_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_KEY_HANDLE_OFFSET">SCRATCH_KEY_HANDLE_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_NONCERT_LENGTH">SCRATCH_NONCERT_LENGTH</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_PAD">SCRATCH_PAD</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_PAD_SIZE">SCRATCH_PAD_SIZE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_PUBLIC_KEY_OFFSET">SCRATCH_PUBLIC_KEY_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_SIGNATURE_LENGTH">SCRATCH_SIGNATURE_LENGTH</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_SIGNATURE_OFFSET">SCRATCH_SIGNATURE_OFFSET</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SCRATCH_TRANSPORT_STATE">SCRATCH_TRANSPORT_STATE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#scratchPersistent">scratchPersistent</a></span></code>
<div class="block">saves status of user presence</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#securityState">securityState</a></span></code>
<div class="block">security state can be <a href="../../../de/tsenger/u2f/States.html#UNINITIALIZED"><code>States.UNINITIALIZED</code></a>, <a href="../../../de/tsenger/u2f/States.html#DELIVERY_STATE"><code>States.DELIVERY_STATE</code></a> or <a href="../../../de/tsenger/u2f/States.html#READY_FOR_USE"><code>States.READY_FOR_USE</code></a></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#SIGNATURE_MAX">SIGNATURE_MAX</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#TRANSPORT_EXTENDED">TRANSPORT_EXTENDED</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#TRANSPORT_NONE">TRANSPORT_NONE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#TRANSPORT_NOT_EXTENDED">TRANSPORT_NOT_EXTENDED</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#TRANSPORT_NOT_EXTENDED_CERT">TRANSPORT_NOT_EXTENDED_CERT</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#TRANSPORT_NOT_EXTENDED_SIGNATURE">TRANSPORT_NOT_EXTENDED_SIGNATURE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#VENDOR_SPECIFIC_RESET">VENDOR_SPECIFIC_RESET</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#VENDOR_SPECIFIC_SET_ATTESTATION_CERT">VENDOR_SPECIFIC_SET_ATTESTATION_CERT</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#VERSION">VERSION</a></span></code>
<div class="block">fix value to indicate u2f support as defined in FIDO specification "FIDO U2F Raw Message Formats"</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#U2FApplet-byte:A-short-byte-">U2FApplet</a></span>(byte[]&nbsp;parameters,
         short&nbsp;parametersOffset,
         byte&nbsp;parametersLength)</code>
<div class="block">Applet constructor will be instantiate at the installation on card.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#handleAuthenticate-javacard.framework.APDU-">handleAuthenticate</a></span>(javacard.framework.APDU&nbsp;apdu)</code>
<div class="block">Process FIDO Authentication Request Message - U2F_AUTHENTICATE
 This function will check if user presence check is need and enforce it if needed.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#handleGetResponse-javacard.framework.APDU-">handleGetResponse</a></span>(javacard.framework.APDU&nbsp;apdu)</code>
<div class="block">Handle APDU chaining (see ISO 7816-4 Section A.4) if extended length APDUs can't be used.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#handleRegister-javacard.framework.APDU-">handleRegister</a></span>(javacard.framework.APDU&nbsp;apdu)</code>
<div class="block">Process FIDO Registration Request Message - U2F_REGISTER
 This function will check if user presence check is need and enforce it if needed.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#handleReset-javacard.framework.APDU-">handleReset</a></span>(javacard.framework.APDU&nbsp;apdu)</code>
<div class="block">Resets the card specific keys for KDF and MAC and set FIDO signing counter to zero
 This function will check if user presence check is need and enforce it if needed.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#handleSetAttestationCert-javacard.framework.APDU-">handleSetAttestationCert</a></span>(javacard.framework.APDU&nbsp;apdu)</code>
<div class="block">Incoming attestation certificate data will be proceeded and stored in reserved array.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#handleVersion-javacard.framework.APDU-">handleVersion</a></span>(javacard.framework.APDU&nbsp;apdu)</code>
<div class="block">Handle FIDO command U2F_VERSION and return version string 'U2F_V2'</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#install-byte:A-short-byte-">install</a></span>(byte[]&nbsp;bArray,
       short&nbsp;bOffset,
       byte&nbsp;bLength)</code>
<div class="block">To create an instance of the U2FApplet, the Java Card runtime environment will call this static method first.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../de/tsenger/u2f/U2FApplet.html#process-javacard.framework.APDU-">process</a></span>(javacard.framework.APDU&nbsp;apdu)</code>
<div class="block">Process incoming APDUs.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.javacard.framework.Applet">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;javacard.framework.Applet</h3>
<code>deselect, getShareableInterfaceObject, register, register, reSelectingApplet, select, selectingApplet</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="securityState">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>securityState</h4>
<pre>private static&nbsp;short securityState</pre>
<div class="block">security state can be <a href="../../../de/tsenger/u2f/States.html#UNINITIALIZED"><code>States.UNINITIALIZED</code></a>, <a href="../../../de/tsenger/u2f/States.html#DELIVERY_STATE"><code>States.DELIVERY_STATE</code></a> or <a href="../../../de/tsenger/u2f/States.html#READY_FOR_USE"><code>States.READY_FOR_USE</code></a></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../de/tsenger/u2f/States.html" title="class in de.tsenger.u2f"><code>States</code></a></dd>
</dl>
</li>
</ul>
<a name="flags">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flags</h4>
<pre>private static&nbsp;byte flags</pre>
<div class="block">provide 0x00 for normal operation at installation, or 0x01 to disable user presence check (for automated FIDO interoperability tests)</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../de/tsenger/u2f/U2FApplet.html#U2FApplet-byte:A-short-byte-"><code>U2FApplet(byte[], short, byte)</code></a></dd>
</dl>
</li>
</ul>
<a name="fidoSigningCounter">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fidoSigningCounter</h4>
<pre>private static&nbsp;byte[] fidoSigningCounter</pre>
<div class="block">counts FIDO signing operations with EC private Key</div>
</li>
</ul>
<a name="scratchPersistent">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>scratchPersistent</h4>
<pre>private static&nbsp;byte[] scratchPersistent</pre>
<div class="block">saves status of user presence</div>
</li>
</ul>
<a name="scratch">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>scratch</h4>
<pre>private static&nbsp;byte[] scratch</pre>
<div class="block">working buffer for reading commands, building responses and temporary data</div>
</li>
</ul>
<a name="attestationCertificate">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>attestationCertificate</h4>
<pre>private static&nbsp;byte[] attestationCertificate</pre>
<div class="block">permanent store for the attestation certificate</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../de/tsenger/u2f/U2FApplet.html#handleSetAttestationCert-javacard.framework.APDU-"><code>handleSetAttestationCert(APDU)</code></a></dd>
</dl>
</li>
</ul>
<a name="attestationPrivateKey">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>attestationPrivateKey</h4>
<pre>private static&nbsp;javacard.security.ECPrivateKey attestationPrivateKey</pre>
<div class="block">stores the private key of the attestation certificate</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../de/tsenger/u2f/U2FApplet.html#U2FApplet-byte:A-short-byte-"><code>U2FApplet(byte[], short, byte)</code></a></dd>
</dl>
</li>
</ul>
<a name="localPrivateKey">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>localPrivateKey</h4>
<pre>protected&nbsp;javacard.security.ECPrivateKey localPrivateKey</pre>
<div class="block">private key for FIDO signing operation</div>
</li>
</ul>
<a name="counterOverflowed">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>counterOverflowed</h4>
<pre>private static&nbsp;boolean counterOverflowed</pre>
<div class="block">Saves the state for the signing counter. Set to true if counter exceeds value 0xFFFFFFFF</div>
</li>
</ul>
<a name="attestationSignature">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>attestationSignature</h4>
<pre>private static&nbsp;javacard.security.Signature attestationSignature</pre>
<div class="block">signature instance for attestation certificate signing</div>
</li>
</ul>
<a name="localSignature">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>localSignature</h4>
<pre>private static&nbsp;javacard.security.Signature localSignature</pre>
<div class="block">signature instance for FIDO signing operation</div>
</li>
</ul>
<a name="fidoImpl">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fidoImpl</h4>
<pre>private static&nbsp;<a href="../../../de/tsenger/u2f/FIDOCCImplementation.html" title="class in de.tsenger.u2f">FIDOCCImplementation</a> fidoImpl</pre>
<div class="block">instance of FIDO API crypto implementation, here the pseudo code of FIDO U2F PP gets real ...</div>
</li>
</ul>
<a name="VERSION">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>VERSION</h4>
<pre>private static final&nbsp;byte[] VERSION</pre>
<div class="block">fix value to indicate u2f support as defined in FIDO specification "FIDO U2F Raw Message Formats"</div>
</li>
</ul>
<a name="FIDO_CLA">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FIDO_CLA</h4>
<pre>private static final&nbsp;byte FIDO_CLA</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.FIDO_CLA">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="FIDO_INS_U2F_REGISTER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FIDO_INS_U2F_REGISTER</h4>
<pre>private static final&nbsp;byte FIDO_INS_U2F_REGISTER</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.FIDO_INS_U2F_REGISTER">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="FIDO_INS_AUTHENTICATE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FIDO_INS_AUTHENTICATE</h4>
<pre>private static final&nbsp;byte FIDO_INS_AUTHENTICATE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.FIDO_INS_AUTHENTICATE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="FIDO_INS_VERSION">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FIDO_INS_VERSION</h4>
<pre>private static final&nbsp;byte FIDO_INS_VERSION</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.FIDO_INS_VERSION">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ISO_INS_GET_RESPONSE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ISO_INS_GET_RESPONSE</h4>
<pre>private static final&nbsp;byte ISO_INS_GET_RESPONSE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.ISO_INS_GET_RESPONSE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROPRIETARY_CLA">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROPRIETARY_CLA</h4>
<pre>private static final&nbsp;byte PROPRIETARY_CLA</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.PROPRIETARY_CLA">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="VENDOR_SPECIFIC_SET_ATTESTATION_CERT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>VENDOR_SPECIFIC_SET_ATTESTATION_CERT</h4>
<pre>private static final&nbsp;byte VENDOR_SPECIFIC_SET_ATTESTATION_CERT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.VENDOR_SPECIFIC_SET_ATTESTATION_CERT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="VENDOR_SPECIFIC_RESET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>VENDOR_SPECIFIC_RESET</h4>
<pre>private static final&nbsp;byte VENDOR_SPECIFIC_RESET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.VENDOR_SPECIFIC_RESET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_TRANSPORT_STATE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_TRANSPORT_STATE</h4>
<pre>private static final&nbsp;byte SCRATCH_TRANSPORT_STATE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_TRANSPORT_STATE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_CURRENT_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_CURRENT_OFFSET</h4>
<pre>private static final&nbsp;byte SCRATCH_CURRENT_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_CURRENT_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_NONCERT_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_NONCERT_LENGTH</h4>
<pre>private static final&nbsp;byte SCRATCH_NONCERT_LENGTH</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_NONCERT_LENGTH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_INCLUDE_CERT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_INCLUDE_CERT</h4>
<pre>private static final&nbsp;byte SCRATCH_INCLUDE_CERT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_INCLUDE_CERT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_SIGNATURE_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_SIGNATURE_LENGTH</h4>
<pre>private static final&nbsp;byte SCRATCH_SIGNATURE_LENGTH</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_SIGNATURE_LENGTH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_FULL_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_FULL_LENGTH</h4>
<pre>private static final&nbsp;byte SCRATCH_FULL_LENGTH</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_FULL_LENGTH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_PAD">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_PAD</h4>
<pre>private static final&nbsp;byte SCRATCH_PAD</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_PAD">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ENROLL_FIXED_RESPONSE_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ENROLL_FIXED_RESPONSE_SIZE</h4>
<pre>private static final&nbsp;short ENROLL_FIXED_RESPONSE_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.ENROLL_FIXED_RESPONSE_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="KEYHANDLE_MAX">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>KEYHANDLE_MAX</h4>
<pre>private static final&nbsp;short KEYHANDLE_MAX</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.KEYHANDLE_MAX">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SIGNATURE_MAX">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SIGNATURE_MAX</h4>
<pre>private static final&nbsp;short SIGNATURE_MAX</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SIGNATURE_MAX">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_PAD_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_PAD_SIZE</h4>
<pre>private static final&nbsp;short SCRATCH_PAD_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_PAD_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ENROLL_PUBLIC_KEY_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ENROLL_PUBLIC_KEY_OFFSET</h4>
<pre>private static final&nbsp;short ENROLL_PUBLIC_KEY_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.ENROLL_PUBLIC_KEY_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ENROLL_KEY_HANDLE_LENGTH_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ENROLL_KEY_HANDLE_LENGTH_OFFSET</h4>
<pre>private static final&nbsp;short ENROLL_KEY_HANDLE_LENGTH_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.ENROLL_KEY_HANDLE_LENGTH_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ENROLL_KEY_HANDLE_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ENROLL_KEY_HANDLE_OFFSET</h4>
<pre>private static final&nbsp;short ENROLL_KEY_HANDLE_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.ENROLL_KEY_HANDLE_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_PUBLIC_KEY_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_PUBLIC_KEY_OFFSET</h4>
<pre>private static final&nbsp;short SCRATCH_PUBLIC_KEY_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_PUBLIC_KEY_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_KEY_HANDLE_LENGTH_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_KEY_HANDLE_LENGTH_OFFSET</h4>
<pre>private static final&nbsp;short SCRATCH_KEY_HANDLE_LENGTH_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_KEY_HANDLE_LENGTH_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_KEY_HANDLE_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_KEY_HANDLE_OFFSET</h4>
<pre>private static final&nbsp;short SCRATCH_KEY_HANDLE_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_KEY_HANDLE_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCRATCH_SIGNATURE_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCRATCH_SIGNATURE_OFFSET</h4>
<pre>private static final&nbsp;short SCRATCH_SIGNATURE_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.SCRATCH_SIGNATURE_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TRANSPORT_NONE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TRANSPORT_NONE</h4>
<pre>private static final&nbsp;byte TRANSPORT_NONE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.TRANSPORT_NONE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TRANSPORT_EXTENDED">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TRANSPORT_EXTENDED</h4>
<pre>private static final&nbsp;byte TRANSPORT_EXTENDED</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.TRANSPORT_EXTENDED">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TRANSPORT_NOT_EXTENDED">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TRANSPORT_NOT_EXTENDED</h4>
<pre>private static final&nbsp;byte TRANSPORT_NOT_EXTENDED</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.TRANSPORT_NOT_EXTENDED">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TRANSPORT_NOT_EXTENDED_CERT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TRANSPORT_NOT_EXTENDED_CERT</h4>
<pre>private static final&nbsp;byte TRANSPORT_NOT_EXTENDED_CERT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.TRANSPORT_NOT_EXTENDED_CERT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TRANSPORT_NOT_EXTENDED_SIGNATURE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TRANSPORT_NOT_EXTENDED_SIGNATURE</h4>
<pre>private static final&nbsp;byte TRANSPORT_NOT_EXTENDED_SIGNATURE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.TRANSPORT_NOT_EXTENDED_SIGNATURE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="P1_SIGN_CHECK_ONLY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>P1_SIGN_CHECK_ONLY</h4>
<pre>private static final&nbsp;byte P1_SIGN_CHECK_ONLY</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.P1_SIGN_CHECK_ONLY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="P1_SIGN_ENFORCE_USER_PRESENCE_AND_SIGN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>P1_SIGN_ENFORCE_USER_PRESENCE_AND_SIGN</h4>
<pre>private static final&nbsp;byte P1_SIGN_ENFORCE_USER_PRESENCE_AND_SIGN</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.P1_SIGN_ENFORCE_USER_PRESENCE_AND_SIGN">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="P1_SIGN_DONT_ENFORCE_USER_PRESENCE_AND_SIGN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>P1_SIGN_DONT_ENFORCE_USER_PRESENCE_AND_SIGN</h4>
<pre>private static final&nbsp;byte P1_SIGN_DONT_ENFORCE_USER_PRESENCE_AND_SIGN</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.P1_SIGN_DONT_ENFORCE_USER_PRESENCE_AND_SIGN">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ENROLL_LEGACY_VERSION">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ENROLL_LEGACY_VERSION</h4>
<pre>private static final&nbsp;byte ENROLL_LEGACY_VERSION</pre>
<div class="block">fix value defined in FIDO specification "FIDO U2F Raw Message Formats"</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.ENROLL_LEGACY_VERSION">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="RFU_ENROLL_SIGNED_VERSION">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>RFU_ENROLL_SIGNED_VERSION</h4>
<pre>private static final&nbsp;byte[] RFU_ENROLL_SIGNED_VERSION</pre>
<div class="block">fix value defined in FIDO specification "FIDO U2F Raw Message Formats"</div>
</li>
</ul>
<a name="APDU_CHALLENGE_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>APDU_CHALLENGE_OFFSET</h4>
<pre>private static final&nbsp;short APDU_CHALLENGE_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.APDU_CHALLENGE_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="APDU_APPLICATION_PARAMETER_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>APDU_APPLICATION_PARAMETER_OFFSET</h4>
<pre>private static final&nbsp;short APDU_APPLICATION_PARAMETER_OFFSET</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.APDU_APPLICATION_PARAMETER_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="FLAG_USER_PRESENCE_VERIFIED">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FLAG_USER_PRESENCE_VERIFIED</h4>
<pre>private static final&nbsp;byte FLAG_USER_PRESENCE_VERIFIED</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.FLAG_USER_PRESENCE_VERIFIED">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="INSTALL_FLAG_DISABLE_USER_PRESENCE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>INSTALL_FLAG_DISABLE_USER_PRESENCE</h4>
<pre>private static final&nbsp;byte INSTALL_FLAG_DISABLE_USER_PRESENCE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.INSTALL_FLAG_DISABLE_USER_PRESENCE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="FIDO_SW_TEST_OF_PRESENCE_REQUIRED">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FIDO_SW_TEST_OF_PRESENCE_REQUIRED</h4>
<pre>private static final&nbsp;short FIDO_SW_TEST_OF_PRESENCE_REQUIRED</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.FIDO_SW_TEST_OF_PRESENCE_REQUIRED">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="FIDO_SW_INVALID_KEY_HANDLE">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>FIDO_SW_INVALID_KEY_HANDLE</h4>
<pre>private static final&nbsp;short FIDO_SW_INVALID_KEY_HANDLE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#de.tsenger.u2f.U2FApplet.FIDO_SW_INVALID_KEY_HANDLE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="U2FApplet-byte:A-short-byte-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>U2FApplet</h4>
<pre>public&nbsp;U2FApplet(byte[]&nbsp;parameters,
                 short&nbsp;parametersOffset,
                 byte&nbsp;parametersLength)</pre>
<div class="block">Applet constructor will be instantiate at the installation on card. Following steps will be performed during instantiation:
 <ul>
                <li> 
                initialize signature counter as byte array with length 4. Each FIFO-Signing command will increase counter by 1. 
                If counter reaches value 0xFFFFFFFF (4.294.967.295 dec) the FIDO signing command will stop working and applet will return SW 0x6A84
                </li>
                <li>
                initialize user presence status byte: save status of user presence: Only one signing command will be execute, 
                after that the card must be reset (remove card from reader and reinsert card) before next signing command will be accepted.
                </li>
                <li>
                initialize transient byte array as buffer for different operations
                </li>
                <li>
                create and initialize Signature instance with ALG_ECDSA_SHA_256 for attestation certificate signing
                </li>
                <li>
                create Signature instance with ALG_ECDSA_SHA_256 for FIDO authentication process (signing AppID | challenge)
                </li>
                <li>
                store flag parameter (from given parameters)
                </li>
                <li>
                create store (with length defined in parameters) for attestation certificate 
                </li>
                <li>
                create ECPrivateKey store and save given (in parameters) private attestation key (for attestation certificate)
                </li>
                <li>
                create FIDO crypto instance
                </li>
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>parameters</code> - (also described in User Guidance (AGD)): 
                <ul>
                        <li> 1 byte: flag to enable (byte set to 0x00) or disable(byte set to 0x01) user presence check</li>
                        <li> 2 bytes: the length in bytes of attestation certificate which will be upload to card in personalization step.</li>
                        <li> 32 bytes: private key of attestation certificate (ec key for curve Secp256r1)</li>
                </ul></dd>
<dd><code>parametersOffset</code> - starting offset in parameters</dd>
<dd><code>parametersLength</code> - length of parameters. MUST be be 35. All other length will throw ISOException "Wrong Data", SW 0x6A80</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="handleSetAttestationCert-javacard.framework.APDU-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleSetAttestationCert</h4>
<pre>private&nbsp;void&nbsp;handleSetAttestationCert(javacard.framework.APDU&nbsp;apdu)
                               throws javacard.framework.ISOException</pre>
<div class="block">Incoming attestation certificate data will be proceeded and stored in reserved array. The array size was set up as parameter at the instantiation of the applet.
 see parameter list in <a href="../../../de/tsenger/u2f/U2FApplet.html#U2FApplet-byte:A-short-byte-"><code>U2FApplet(byte[], short, byte)</code></a>
 This method will switch the applet to state <a href="../../../de/tsenger/u2f/States.html#READY_FOR_USE"><code>States.READY_FOR_USE</code></a> after the array is complete filled. Certificate bytes can be send in chunks of arbitrary size. 
 Since array is not completed filled applet will stay in personalization mode. This method will <b>not</b> verify if stored private key matches to the attestation certificates public key.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>apdu</code> - Incoming APDU which should contain attestation certificate bytes</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javacard.framework.ISOException</code> - Will throw SW Wrong Data 0x6A80 if the length of the data in APDU will exceed the reserved array length for the attestation certificate.</dd>
</dl>
</li>
</ul>
<a name="handleRegister-javacard.framework.APDU-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleRegister</h4>
<pre>private&nbsp;void&nbsp;handleRegister(javacard.framework.APDU&nbsp;apdu)
                     throws javacard.framework.ISOException</pre>
<div class="block">Process FIDO Registration Request Message - U2F_REGISTER
 This function will check if user presence check is need and enforce it if needed. The internal FIDO signing counter will be checked before function "getPubKeyAndKeyHandle" will be called.
 Builds key handle, user public key and return it together with the attestation certificate and a signature as specified in 
 FIDO specification "FIDO U2F Raw Message Formats". Calls method <a href="../../../de/tsenger/u2f/FIDOCCImplementation.html#getPubKeyAndKeyHandle-byte:A-short-byte:A-short-byte:A-short-"><code>FIDOCCImplementation.getPubKeyAndKeyHandle(byte[] applicationParameter, short applicationParameterOffset, byte[] publicKey, short publicKeyOffset, byte[] keyHandle, short keyHandleOffset)</code></a>
 and if needed <a href="../../../de/tsenger/u2f/U2FApplet.html#handleGetResponse-javacard.framework.APDU-"><code>handleGetResponse(APDU)</code></a>.
 Fails if data field doesn't contain exactly 64 bytes, if user presence cannot be validated or if signing counter is full.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>apdu</code> - Expects APDU with 64 Byte data. First 32 bytes shall contain the challenge parameter, 
                  followed by 32 bytes application parameter</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javacard.framework.ISOException</code> - Returns the following SW if an exception occurs:
        <ul>
                <li> SW 0x6700 if data field doesn't contain exactly 64 bytes</li>
                <li> SW 0x6985 if user presence is required</li>
                <li> SW 0x6a84 if signing counter exceed its limit</li>
        </ul></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../de/tsenger/u2f/FIDOCCImplementation.html#getPubKeyAndKeyHandle-byte:A-short-byte:A-short-byte:A-short-"><code>FIDOCCImplementation.getPubKeyAndKeyHandle(byte[] applicationParameter, short applicationParameterOffset, byte[] publicKey, short publicKeyOffset, byte[] keyHandle, short keyHandleOffset)</code></a>, 
<a href="../../../de/tsenger/u2f/U2FApplet.html#handleGetResponse-javacard.framework.APDU-"><code>handleGetResponse(APDU)</code></a></dd>
</dl>
</li>
</ul>
<a name="handleAuthenticate-javacard.framework.APDU-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleAuthenticate</h4>
<pre>private&nbsp;void&nbsp;handleAuthenticate(javacard.framework.APDU&nbsp;apdu)
                         throws javacard.framework.ISOException</pre>
<div class="block">Process FIDO Authentication Request Message - U2F_AUTHENTICATE
 This function will check if user presence check is need and enforce it if needed. The internal FIDO signing counter will be checked before method <a href="../../../de/tsenger/u2f/FIDOCCImplementation.html#getSigningKey-byte:A-short-short-byte:A-short-javacard.security.ECPrivateKey-"><code>FIDOCCImplementation.getSigningKey(byte[], short, short, byte[], short, ECPrivateKey)</code></a>  will be called.
 getSigningKey will return the FIDO EC private if APDU parameter P1 contains value <a href="../../../de/tsenger/u2f/U2FApplet.html#P1_SIGN_ENFORCE_USER_PRESENCE_AND_SIGN"><code>P1_SIGN_ENFORCE_USER_PRESENCE_AND_SIGN</code></a>. Otherwise it will only be checked if a valid registration exists. 
 See FIDO specification "FIDO U2F Raw Message Formats" for details on this parameter. If FIDO EC private is returned from function getSigningKey it will be used to sign the input data as 
 described in FIDO specification. For signing it uses the platforms signing function provided by the JavaCard Signature object. This complies FCS_COP.1.
 After getting the signature or at any error that may occur the FIDO EC private will be securely deleted by using the platforms method <code>Key.clearKey()</code>. This complies FCS_CKM.4. The signature will be processed 
 and packed into valid FIDO messages and returned either in one Response APDU (if extended length is supported) or as multiple data blocks (which needs to process multiple GET_RESPONSE APDUs <a href="../../../de/tsenger/u2f/U2FApplet.html#handleGetResponse-javacard.framework.APDU-"><code>handleGetResponse(APDU)</code></a>).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>apdu</code> - Expects APDU with at least 65 Byte data. See FIDO specification "FIDO U2F Raw Message Formats" for detailed input data description.
                           Parameter P1 controls the operation mode. 0x07 "check-only", 0x03 "enforce-user-presence-and-sign" or 0x08 "dont-enforce-user-presence-and-sign"
                           are valid values for P1. All other values will result in an ISOException</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javacard.framework.ISOException</code> - Returns the following SW if an exception occurs:
        <ul>
                <li> SW 0x6700 if data field contains less than 65 bytes</li>
                <li> SW 0x6a86 if P1 contains invalid data</li>
                <li> SW 0x6a84 if signing counter exceed its limit</li>
                <li> SW 0x6a80 if key handle verification failed</li>
                <li> SW 0x6985 if user presence is required, could also signal success conditions for "check only" operation if P1 was set to 0x07</li>
        </ul></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../de/tsenger/u2f/U2FApplet.html#handleGetResponse-javacard.framework.APDU-"><code>handleGetResponse(APDU)</code></a>, 
<a href="../../../de/tsenger/u2f/FIDOCCImplementation.html#getSigningKey-byte:A-short-short-byte:A-short-javacard.security.ECPrivateKey-"><code>FIDOCCImplementation.getSigningKey(byte[] keyHandle, short keyHandleOffset, short keyHandleLength, byte[] applicationParameter, short applicationParameterOffset, ECPrivateKey regeneratedPrivateKey)</code></a></dd>
</dl>
</li>
</ul>
<a name="handleVersion-javacard.framework.APDU-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleVersion</h4>
<pre>private&nbsp;void&nbsp;handleVersion(javacard.framework.APDU&nbsp;apdu)
                    throws javacard.framework.ISOException</pre>
<div class="block">Handle FIDO command U2F_VERSION and return version string 'U2F_V2'</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>apdu</code> - APDU object to use for response</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javacard.framework.ISOException</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../de/tsenger/u2f/U2FApplet.html#VERSION"><code>VERSION</code></a></dd>
</dl>
</li>
</ul>
<a name="handleGetResponse-javacard.framework.APDU-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleGetResponse</h4>
<pre>private&nbsp;void&nbsp;handleGetResponse(javacard.framework.APDU&nbsp;apdu)</pre>
<div class="block">Handle APDU chaining (see ISO 7816-4 Section A.4) if extended length APDUs can't be used. Also defined in FIDO NFC Protocol Specification.
 If responses in method handleAuthenticate(APDU apdu) or handleRegister(APDU apdu) couldn't be transceived in one response APDU, the client can call get the response data in multiple
 smaller data blocks. This function will indicate how much data is still available to get in the SW (see ISO 7816 or FIDO U2F specification).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>apdu</code> - only parameter "Le" field of incoming APDU which will be processes. If "Le" field contains only bytes set to '00' then all the available data bytes will be returned within the limit of 256</dd>
</dl>
</li>
</ul>
<a name="handleReset-javacard.framework.APDU-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleReset</h4>
<pre>private&nbsp;void&nbsp;handleReset(javacard.framework.APDU&nbsp;apdu)</pre>
<div class="block">Resets the card specific keys for KDF and MAC and set FIDO signing counter to zero
 This function will check if user presence check is need and enforce it if needed. Calls method <a href="../../../de/tsenger/u2f/FIDOCCImplementation.html#eraseKeys-short-"><code>FIDOCCImplementation.eraseKeys(short actualState)</code></a> with actual internal applet state.
 After successful clearing the keys the new status is States.DELIVERY_STATE. Then the FIDO signing counter will be reset to zero and the initialization of new seed and MACKey will be
 triggered by calling method <a href="../../../de/tsenger/u2f/FIDOCCImplementation.html#initializeKeys-short-"><code>FIDOCCImplementation.initializeKeys(short actualState)</code></a>. New state will be return from this method and set as internal applet state.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>apdu</code> - received APDU which contains the instruction for clearing the keys</dd>
</dl>
</li>
</ul>
<a name="process-javacard.framework.APDU-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>process</h4>
<pre>public&nbsp;void&nbsp;process(javacard.framework.APDU&nbsp;apdu)
             throws javacard.framework.ISOException</pre>
<div class="block">Process incoming APDUs. Handle all FIDO defined commands and vendor specific commands needed for personalization and operation:
        <ul>
                <li>U2F_REGISTER</li>
                <li>U2F_AUTHENTICATE</li>
                <li>U2F_VERSION</li>
                <li>GET RESPONSE</li>
                <li>SET ATTESTATION CERT</li>
                <li>RESET</li>
        </ul>
 After receiving the incoming APDU it will be check if the internal state of this applet allows the processing of the command. 
 It will be also checked if the APDU contain the correct CLA-Byte for the command which was requested. If the incoming APDU contains a known instruction byte 
 the command will be dispatched to the function that handles the APDU. Response APDU will be generated and send out by the command handler functions (handleXYZ).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>process</code>&nbsp;in class&nbsp;<code>javacard.framework.Applet</code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>apdu</code> - The APDU object which comes from the underlying JavaCard platform. It contains the APDU which this applet is going to process.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javacard.framework.ISOException</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><code>Applet.process(javacard.framework.APDU)</code></dd>
</dl>
</li>
</ul>
<a name="install-byte:A-short-byte-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>install</h4>
<pre>public static&nbsp;void&nbsp;install(byte[]&nbsp;bArray,
                           short&nbsp;bOffset,
                           byte&nbsp;bLength)
                    throws javacard.framework.ISOException</pre>
<div class="block">To create an instance of the U2FApplet, the Java Card runtime environment will call this static method first.
 Installation parameters are supplied in the bArray parameter. Here we extract the parameters which we need to call the U2FApplet constructor.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bArray</code> - the array containing installation parameters</dd>
<dd><code>bOffset</code> - the starting offset in bArray</dd>
<dd><code>bLength</code> - the length in bytes of the parameter data in bArray The maximum value of bLength is 127.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javacard.framework.ISOException</code> - if the install method failed</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><code>Applet.install(byte[], short, byte)</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../de/tsenger/u2f/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/U2FApplet.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../de/tsenger/u2f/States.html" title="class in de.tsenger.u2f"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?de/tsenger/u2f/U2FApplet.html" target="_top">Frames</a></li>
<li><a href="U2FApplet.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
